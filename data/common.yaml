---
rsyslog::confdir: /etc/rsyslog.d
rsyslog::package_name: rsyslog
rsyslog::package_version: installed
rsyslog::manage_package: true
rsyslog::manage_confdir: true
rsyslog::purge_config_files: true
rsyslog::override_default_config: true
rsyslog::config_file: /etc/rsyslog.conf
rsyslog::service_name: rsyslog
rsyslog::service_status: running
rsyslog::service_enabled: true

## This can be an array of extra "feature" packages to install for rsyslog
rsyslog::feature_packages: []

## Default object type priorities (can be overridden)
rsyslog::module_load_priority: 10
rsyslog::input_priority: 15
rsyslog::global_config_priority: 20
rsyslog::main_queue_priority: 25
rsyslog::template_priority: 30
rsyslog::action_priority: 40
rsyslog::custom_priority: 90
rsyslog::target_file: 50_rsyslog.conf

# rsyslog::modules
# This sets modules that will be loaded
#
rsyslog::modules:
  - imuxsock
  - imklog

rsyslog::global_config:
  parser.SomeConfigurationOption: 
    value: 'on'
  EscapeControlCharactersOnReceive:
    value: 'off'
    type: legacy
    
rsyslog::main_queue_opts:
  queue.maxdiskspace: 1000G
  queue.dequeuebatchsize: 1000

#
#
rsyslog::templates:
  remote:
    type: string
    string: "/var/log/rsyslog/logs/%fromhost-ip%/%fromhost-ip%.log"
  tpl2:
    type: subtree
    subtree: "$1!$usr"
  someplug:
     type: plugin
     plugin: foobar
     options:
       sql: "on"
  plain-syslog:
    type: list
    list_descriptions:
      - constant:
          value: '{'
      - constant:
          value: '\"@timestamp\":\"'
      - constant:
          value: '\"@remove_me_timestamp\":\"'
      - property:
         name: timereported
         dateFormat: rfc3339
      - constant:
         value: '\"host\":\"'
      - property:
         name: hostname
      - constant:
         value: '\"severity\":\"'
      - property:
         name: syslogseverity-text
      - constant:
         value: '\"facility\":\"'
      - property:
         name: syslogfacility-text
      - constant:
         value: '\"tag\":\"'
      - property:
         name: syslogtag
         format: json
      - constant:
         value: '\"message\":\"'
      - property:
         name: msg
         format: json
      - constant:
         value: '\"}'




#
rsyslog::actions:
  elasticsearch:
    type: omelasticsearch
    config:
      queue.type: "linkedlist"
      queue.spoolDirectory: /var/log/rsyslog/queue

  plankofwoodsearch:
    type: omplankofwoodsearch
    config:
      queue.type: "linkedlist"
      queue.spoolDirectory: /var/log/rsyslog/queue
    format: |
      if [ "foo" = "bar" ] then {
      <%= $content %>
      } else {

  maybeofwoodsearch:
    type: ommaybeofwoodsearch
    config:
      queue.type: "linkedlist"
      queue.spoolDirectory: /var/log/rsyslog/queue
    format: |
      <%= $content %>
      }

  elsecondofwoodsearch:
    type: omelsecondofwoodsearch
    config:
      queue.type: "linkedlist"
      queue.spoolDirectory: /var/log/rsyslog/queue

   
rsyslog::inputs:
  imudp:
    type: imudp
    config:
      queue.type: "linkedlist"
      queue.spoolDirectory: /var/log/rsyslog/queue
   
rsyslog::custom_config:
  localhost_action:
    priority: 45
    content: |
      if $fromhost == ["apl00036i2","localhost"] then {
        action(type="omfile" file="/var/log/syslog")
      }
    
